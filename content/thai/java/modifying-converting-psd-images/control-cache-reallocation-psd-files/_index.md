---
title: ควบคุมการจัดสรรแคชในไฟล์ PSD
linktitle: ควบคุมการจัดสรรแคชในไฟล์ PSD
second_title: Aspose.PSD Java API
description: จัดการการจัดสรรแคชใหม่ในไฟล์ PSD โดยใช้ Aspose.PSD สำหรับ Java เรียนรู้วิธีเพิ่มประสิทธิภาพหน่วยความจำและการจัดการไฟล์อย่างมีประสิทธิภาพ เหมาะสำหรับนักพัฒนา
type: docs
weight: 22
url: /th/java/modifying-converting-psd-images/control-cache-reallocation-psd-files/
---
## การแนะนำ
เมื่อทำงานกับรูปภาพและไฟล์ Photoshop โดยทางโปรแกรม ประสิทธิภาพถือเป็นปัจจัยสำคัญ Aspose.PSD สำหรับ Java นำเสนอฟีเจอร์ที่มีประสิทธิภาพในการจัดการและจัดการไฟล์ PSD ได้อย่างราบรื่น ลักษณะพื้นฐานประการหนึ่งของการเพิ่มประสิทธิภาพการทำงานคือการควบคุมการจัดสรรแคชใหม่ การจัดการแคชช่วยในการรักษาสมดุลระหว่างการใช้หน่วยความจำและดิสก์ ทำให้มั่นใจได้ว่าแอปพลิเคชันของคุณทำงานได้อย่างราบรื่น โดยไม่มีการหยุดทำงานหรือการชะลอตัวที่ไม่คาดคิด 
## ข้อกำหนดเบื้องต้น
ก่อนที่เราจะพูดถึงส่วนการเขียนโค้ด มีบางสิ่งที่คุณต้องแน่ใจก่อนเพื่อให้ทุกอย่างทำงานได้อย่างราบรื่น:
1. Java Development Kit (JDK): ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้ง JDK บนเครื่องของคุณแล้ว คุณสามารถดาวน์โหลดได้จาก[เว็บไซต์ของออราเคิล](https://www.oracle.com/java/technologies/javase-jdk11-downloads.html).
2. Aspose.PSD สำหรับ Java: คุณต้องดาวน์โหลดไลบรารี Aspose.PSD คุณสามารถค้นหารุ่นล่าสุดได้[ที่นี่](https://releases.aspose.com/psd/java/).
3. การตั้งค่า IDE: Integrated Development Environment (IDE) เช่น IntelliJ IDEA หรือ Eclipse จะช่วยให้คุณจัดการโค้ดของคุณได้ง่ายขึ้น
4. ความเข้าใจพื้นฐานของ Java: ความคุ้นเคยกับการเขียนโปรแกรม Java จะช่วยให้คุณเข้าใจแนวคิดและตัวอย่างโค้ดได้ดีขึ้น
5.  Aspose License (ไม่บังคับ): หากคุณต้องการลบลายน้ำและเพิ่มฟังก์ชันการทำงานเต็มรูปแบบ ให้พิจารณาซื้อใบอนุญาต[ที่นี่](https://purchase.aspose.com/buy) หรือทดลองใช้งานฟรี[ที่นี่](https://releases.aspose.com/).
## แพ็คเกจนำเข้า
ก่อนที่เราจะเริ่มเขียนโค้ด เราต้องแน่ใจว่าเราได้นำเข้าแพ็คเกจที่จำเป็นแล้ว ด้านล่างนี้คือรายการสั้นๆ ของสิ่งที่ควรรวมไว้ตอนต้นของไฟล์ Java ของคุณ:
```java
import com.aspose.psd.Cache;
import com.aspose.psd.CacheType;
import com.aspose.psd.Color;
import com.aspose.psd.ColorPalette;
import com.aspose.psd.Image;
import com.aspose.psd.RasterImage;
import com.aspose.psd.imageoptions.GifOptions;
import com.aspose.psd.imageoptions.PsdOptions;
import com.aspose.psd.sources.StreamSource;
import com.aspose.psd.system.io.MemoryStream;
```
## ขั้นตอนที่ 1: การตั้งค่าไดเร็กทอรีข้อมูลของคุณ
ก่อนอื่น คุณจะต้องตั้งค่าไดเร็กทอรีที่คุณต้องการจัดเก็บไฟล์แคชของคุณ นี่เป็นสิ่งสำคัญสำหรับการจัดการแคชอย่างมีประสิทธิภาพ
```java
String dataDir = "Your Document Directory";
Cache.setCacheFolder(dataDir);
```

- สตริง dataDir: กำหนดไดเร็กทอรีสำหรับแคชเอกสารของคุณ
- Cache.setCacheFolder(dataDir): วิธีการนี้จะตั้งค่าโฟลเดอร์แคชไปยังไดเร็กทอรีที่ระบุ แคชใด ๆ ที่สร้างโดย Aspose จะถูกเก็บไว้ที่นี่แทนไดเร็กทอรีชั่วคราวเริ่มต้น
## ขั้นตอนที่ 2: การกำหนดค่าแคชไปยังดิสก์
ต่อไปเราจะระบุว่าเราต้องการให้แคชของเราถูกเก็บไว้ในดิสก์เท่านั้น สิ่งนี้มีประโยชน์อย่างยิ่งหากแอปพลิเคชันของคุณใช้ไฟล์ขนาดใหญ่ และคุณต้องการให้แน่ใจว่าหน่วยความจำยังคงว่าง
```java
Cache.setCacheType(CacheType.CacheOnDiskOnly);
```

- Cache.setCacheType(CacheType.CacheOnDiskOnly): ตัวเลือกนี้ช่วยให้แน่ใจว่าแคชไม่อยู่ในหน่วยความจำ ซึ่งเป็นประโยชน์สำหรับการจัดการไฟล์ PSD ขนาดใหญ่โดยไม่ต้องใช้ RAM มากเกินไป
## ขั้นตอนที่ 3: การตั้งค่าดิสก์สูงสุดและขนาดแคชหน่วยความจำ
ตอนนี้ เรามาจำกัดขนาดแคชของเรากันดีกว่า นี่เป็นสิ่งสำคัญเนื่องจากแคชไม่จำกัดอาจทำให้เกิดปัญหาด้านประสิทธิภาพได้
```java
Cache.setMaxDiskSpaceForCache(1073741824); // 1 กิกะไบต์
Cache.setMaxMemoryForCache(1073741824); // 1 กิกะไบต์
```

- Cache.setMaxDiskSpaceForCache(1073741824): สิ่งนี้จะกำหนดขีดจำกัด 1 GB สำหรับแคชบนดิสก์ คุณสามารถปรับขนาดนี้ได้ตามความต้องการของคุณ
- Cache.setMaxMemoryForCache(1073741824): ในทำนองเดียวกัน สิ่งนี้จะจำกัดแคชในหน่วยความจำ เพื่อให้มั่นใจว่าแอปพลิเคชันของคุณไม่ได้ใช้หน่วยความจำมากเกินไป
## ขั้นตอนที่ 4: จัดการกลยุทธ์การจัดสรรแคช
การจัดการวิธีการจัดสรรแคชเป็นสิ่งจำเป็นสำหรับการรักษาประสิทธิภาพ ต่อไปนี้คือวิธีการตั้งค่า
```java
Cache.setExactReallocateOnly(false);
```

- Cache.setExactReallocateOnly(false): เมื่อตั้งค่าเป็น false จะทำให้ Aspose จัดการการจัดสรรแคชได้อย่างยืดหยุ่นมากขึ้น ซึ่งอาจนำไปสู่ประสิทธิภาพที่ดีขึ้น
## ขั้นตอนที่ 5: ตรวจสอบขนาดแคชที่จัดสรร
ขั้นตอนนี้เป็นเรื่องเกี่ยวกับการตรวจสอบจำนวนไบต์ที่ถูกจัดสรรในปัจจุบันสำหรับแคชในหน่วยความจำหรือบนดิสก์ เรามาดำเนินการกัน:
```java
long l1 = Cache.getAllocatedDiskBytesCount();
long l2 = Cache.getAllocatedMemoryBytesCount();
```

- long l1: เก็บจำนวนไบต์ที่จัดสรรไว้บนดิสก์
- long l2: เก็บจำนวนไบต์ที่จัดสรรไว้ในหน่วยความจำ 
คุณสามารถตรวจสอบค่าเหล่านี้ได้ตลอดเวลาเพื่อให้แน่ใจว่าแอปพลิเคชันของคุณจัดการหน่วยความจำและการใช้งานดิสก์ตามที่คาดไว้
## ขั้นตอนที่ 6: การสร้างรูปภาพ PSD
ตอนนี้เราได้ตั้งค่าแคชแล้ว เรามาสร้างภาพ PSD แบบง่ายๆ กันดีกว่า
```java
PsdOptions options = new PsdOptions();
Color[] color = { Color.getRed(), Color.getBlue(), Color.getBlack(), Color.getWhite() };
options.setPalette(new ColorPalette(color));
options.setSource(new StreamSource(new ByteArrayInputStream(new byte[0])));
RasterImage image = (RasterImage) Image.create(options, 100, 100);
```

- ตัวเลือก PsdOptions: วัตถุนี้ช่วยให้คุณระบุตัวเลือกเมื่อสร้างภาพ Photoshop
- สี[] สี: อาร์เรย์ที่มีสีที่จะใช้ในจานสีรูปภาพ
## ขั้นตอนที่ 7: บันทึกข้อมูลพิกเซลลงในรูปภาพ
ตอนนี้เรามาเติมข้อมูลพิกเซลให้กับรูปภาพของเราแล้วบันทึก
```java
Color[] pixels = new Color[10000];
for (int i = 0; i < pixels.length; i++) {
    pixels[i] = Color.getWhite();
}
image.savePixels(image.getBounds(), pixels);
```

- สี[] พิกเซล: นี่คืออาร์เรย์ของวัตถุสี ตรงนี้ เรากำลังเติมพิกเซลสีขาวลงไป
- image.savePixels(image.getBounds(),pixel): วิธีการนี้จะบันทึกข้อมูลพิกเซลลงในรูปภาพ มันอัปเดตรูปภาพด้วยสีที่เรากำหนดไว้
## ขั้นตอนที่ 8: การตรวจสอบแคชที่จัดสรรหลังจากการสร้างอิมเมจ
หลังจากสร้างอิมเมจแล้ว แนวทางปฏิบัติที่ดีในการตรวจสอบว่ามีการจัดสรรไบต์จำนวนเท่าใดสำหรับแคชอีกครั้ง
```java
long diskBytes = Cache.getAllocatedDiskBytesCount();
long memoryBytes = Cache.getAllocatedMemoryBytesCount();
```

- ยาว diskBytes: จับการจัดสรรปัจจุบันบนดิสก์หลังจากการสร้างอิมเมจ
- หน่วยความจำยาวไบต์: บันทึกการจัดสรรปัจจุบันในหน่วยความจำ 
ขั้นตอนนี้จะช่วยคุณกำหนดจำนวนแคชที่ใช้หลังจากการดำเนินการของคุณ
## ขั้นตอนที่ 9: ตรวจสอบการกำจัดที่เหมาะสม
สุดท้ายนี้ จำเป็นอย่างยิ่งที่จะต้องตรวจสอบให้แน่ใจว่าออบเจ็กต์ Aspose.PSD ทั้งหมดถูกกำจัดอย่างเหมาะสมเพื่อหลีกเลี่ยงไม่ให้หน่วยความจำรั่วไหล
```java
l1 = Cache.getAllocatedDiskBytesCount();
l2 = Cache.getAllocatedMemoryBytesCount();
```

- l1 และ l2: ตัวแปรเหล่านี้จะช่วยคุณตรวจสอบการจัดสรรขั้นสุดท้าย หากค่าเหล่านั้นไม่เป็นศูนย์ แสดงว่าวัตถุบางอย่างไม่ได้ถูกกำจัดอย่างเหมาะสม
## บทสรุป
การควบคุมการจัดสรรแคชใหม่ใน Aspose.PSD สำหรับ Java สามารถสร้างความแตกต่างอย่างมีนัยสำคัญในประสิทธิภาพของแอปพลิเคชันของคุณ ด้วยการทำตามขั้นตอนที่อธิบายไว้ข้างต้น คุณสามารถจัดการแคช ลดการใช้หน่วยความจำ และสร้างไฟล์ PSD ที่สวยงามได้อย่างมีประสิทธิภาพ ยอมรับเทคนิคเหล่านี้ และดูแอปพลิเคชันของคุณเติบโตด้วยประสิทธิภาพสูงสุด!
## คำถามที่พบบ่อย
### Aspose.PSD คืออะไร
Aspose.PSD เป็นไลบรารีสำหรับนักพัฒนา .NET และ Java เพื่อสร้าง จัดการ และแปลงไฟล์ Photoshop (PSD) โดยทางโปรแกรม
### ฉันจะตรวจสอบขนาดแคชที่จัดสรรได้อย่างไร
 ใช้วิธีการเช่น`Cache.getAllocatedDiskBytesCount()` และ`Cache.getAllocatedMemoryBytesCount()` เพื่อตรวจสอบการใช้งานแคชปัจจุบัน
### ฉันสามารถตั้งค่าไดเรกทอรีที่กำหนดเองสำหรับแคชได้หรือไม่
 ได้ คุณสามารถระบุไดเร็กทอรีอื่นได้โดยใช้`Cache.setCacheFolder("Your Directory Path")`.
### Aspose.PSD ใช้งานได้ฟรีหรือไม่
Aspose.PSD เป็นไลบรารีที่ต้องชำระเงิน แต่คุณสามารถเริ่มต้นด้วยการทดลองใช้ฟรีได้[เว็บไซต์](https://releases.aspose.com/).
### จะเกิดอะไรขึ้นหากฉันไม่ทิ้งสิ่งของ?
การไม่ทิ้งวัตถุอาจทำให้หน่วยความจำรั่ว ส่งผลให้แอปพลิเคชันของคุณใช้ทรัพยากรเกินความจำเป็น